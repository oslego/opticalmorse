<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Optical Morse Code</title>
</head>
<body>
  <h1>Optical Morse Code + <em>DeviceLight API</em></h1>

  <script>

  function OpticalServer(params) {
    params = params || {};

    this.wpm = params.wpm || 20;  // words per minute
    this.unit = 1200 / this.wpm; // duration of dot in Morse
    this.luxThreshold = 1000; // min Lux value considered for light "on"

    this.dotDur = this.unit;
    this.dashDur = this.unit * 3;
    this.breakDur = this.unit;
    this.letterBreakDur = this.unit * 3;
    this.wordBreakDur = this.unit * 7;

    this.MORSE_TO_CHAR = {};

    for (var key in this.CHAR_TO_MORSE){
      this.MORSE_TO_CHAR[this.CHAR_TO_MORSE[key]] = key;
    }
  }

  OpticalServer.prototype.CHAR_TO_MORSE = {
    "A": ".-",
    "B": "-...",
    "C": "-.-.",
    "D": "-..",
    "E": ".",
    "F": "..-.",
    "G": "--.",
    "H": "....",
    "I": "..",
    "J": ".---",
    "K": "-.-",
    "L": ".-..",
    "M": "--",
    "N": "-.",
    "O": "---",
    "P": ".--.",
    "Q": "--.-",
    "R": ".-.",
    "S": "...",
    "T": "-",
    "U": "..-",
    "V": "...-",
    "W": ".--",
    "X": "-..-",
    "Y": "-.--",
    "Z": "--..",

    "1": ".----",
    "2": "..---",
    "3": "...--",
    "4": "....-",
    "5": ".....",
    "6": "-....",
    "7": "--...",
    "8": "---..",
    "9": "----.",
    "0": "-----"
  };

  OpticalServer.prototype.start = function() {

  }

  OpticalServer.prototype.stop = function() {

  }

  OpticalServer.prototype.charToMorse = function(char) {
    return this.CHAR_TO_MORSE[char];
  }

  OpticalServer.prototype.morseToChar = function(morse) {
    return this.MORSE_TO_CHAR[morse];
  }

  server = new OpticalServer();
  console.log(server.charToMorse('A'))
  console.log(server.morseToChar('.-'))

  // OpticalServer.minLux
  // OpticalServer.maxLux
  // OpticalServer.timing.dot
  // OpticalServer.timing.dash
  // OpticalServer.timing.break
  // OpticalServer.timing.letterBreak
  // OpticalServer.timing.wordBreak
  // OpticalServer.start()
  // OpticalServer.stop()
  // OpticalServer.on('message', cb)
  // OpticalServer.on('character', cb)


  </script>
</body>
</html>
